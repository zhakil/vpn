# 代理管理系统环境变量配置模板
# 复制此文件为.env并修改相应配置

# ===========================================
# 基础配置
# ===========================================
# 部署环境 (development/staging/production)
NODE_ENV=production

# 域名配置
DOMAIN=your-domain.com
API_DOMAIN=api.your-domain.com

# ===========================================
# 数据库配置  
# ===========================================
# PostgreSQL配置
POSTGRES_DB=proxy_manager
POSTGRES_USER=proxy_admin
POSTGRES_PASSWORD=your_strong_postgres_password_here

# Redis配置
REDIS_PASSWORD=your_strong_redis_password_here

# InfluxDB配置
INFLUXDB_USER=admin
INFLUXDB_PASSWORD=your_strong_influxdb_password_here
INFLUXDB_ORG=proxy-manager-org
INFLUXDB_BUCKET=proxy-metrics
INFLUXDB_TOKEN=your_influxdb_admin_token_here

# ===========================================
# 应用安全配置
# ===========================================
# JWT密钥 (使用openssl rand -hex 32生成)
JWT_SECRET=your_jwt_secret_key_here_must_be_32_chars_minimum

# API密钥加密密钥
API_KEY_SECRET=your_api_key_encryption_secret_here

# 会话密钥
SESSION_SECRET=your_session_secret_key_here

# ===========================================
# 监控配置
# ===========================================
# Grafana配置
GRAFANA_USER=admin
GRAFANA_PASSWORD=your_strong_grafana_password_here

# Prometheus配置
PROMETHEUS_RETENTION=200h

# ===========================================
# SSL证书配置
# ===========================================
# Let's Encrypt邮箱
LETSENCRYPT_EMAIL=your-email@example.com

# SSL证书路径
SSL_CERT_PATH=/etc/nginx/ssl/cert.pem
SSL_KEY_PATH=/etc/nginx/ssl/key.pem

# ===========================================
# 协议配置
# ===========================================
# V2Ray配置
V2RAY_LOG_LEVEL=warning
V2RAY_ACCESS_LOG=/var/log/v2ray/access.log
V2RAY_ERROR_LOG=/var/log/v2ray/error.log

# Clash配置  
CLASH_LOG_LEVEL=info
CLASH_API_SECRET=your_clash_api_secret_here

# Hysteria配置
HYSTERIA_LOG_LEVEL=info

# ===========================================
# 网络配置
# ===========================================
# 代理端口范围
PROXY_PORT_START=10001
PROXY_PORT_END=10100

# API服务端口
API_GATEWAY_PORT=8080
RULE_ENGINE_PORT=8081
CONFIG_MANAGER_PORT=8082
STATS_SERVICE_PORT=8086

# ===========================================
# 性能配置
# ===========================================
# 数据库连接池
DB_MAX_CONNECTIONS=100
DB_IDLE_TIMEOUT=300

# Redis连接池
REDIS_MAX_CONNECTIONS=50

# 限流配置
RATE_LIMIT_WINDOW=60
RATE_LIMIT_MAX=1000

# ===========================================
# 日志配置
# ===========================================
# 日志级别 (debug/info/warn/error)
LOG_LEVEL=info

# 日志轮转配置
LOG_MAX_SIZE=100m
LOG_MAX_FILES=10
LOG_MAX_AGE=30

# ===========================================
# 备份配置
# ===========================================
# 备份存储路径
BACKUP_PATH=/opt/proxy-manager/backups

# 备份保留天数
BACKUP_RETENTION_DAYS=30

# 数据库备份频率 (cron格式)
DB_BACKUP_CRON="0 2 * * *"

# ===========================================
# 通知配置
# ===========================================
# 邮件通知配置 (可选)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your_app_password
SMTP_FROM=noreply@your-domain.com

# Webhook通知配置 (可选)
WEBHOOK_URL=https://hooks.slack.com/services/your/webhook/url

# ===========================================
# 安全配置
# ===========================================
# 允许的源IP (用逗号分隔，留空表示允许所有)
ALLOWED_IPS=

# 启用fail2ban防护
ENABLE_FAIL2BAN=true

# 最大登录失败次数
MAX_LOGIN_ATTEMPTS=5

# 登录失败锁定时间(分钟)
LOGIN_LOCKOUT_TIME=30

# ===========================================
# 开发配置 (仅开发环境)
# ===========================================
# 调试模式
DEBUG=false

# 热重载
HOT_RELOAD=false

# 跨域配置
CORS_ORIGIN=*

# ===========================================
# 扩展配置
# ===========================================
# 插件目录
PLUGIN_DIR=/opt/proxy-manager/plugins

# 临时文件目录  
TEMP_DIR=/tmp/proxy-manager

# 最大文件上传大小
MAX_UPLOAD_SIZE=10MB